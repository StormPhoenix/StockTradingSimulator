# æ—¶é—´åºåˆ—æ¨¡æ‹Ÿä¸å¯è§†åŒ–

## ğŸ“Š åŠŸèƒ½æ¦‚è¿°

æœ¬åŠŸèƒ½æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„æ—¶é—´åºåˆ—æ•°æ®æ¨¡æ‹Ÿå’Œå¯è§†åŒ–ç³»ç»Ÿï¼ŒåŒ…æ‹¬ï¼š

- **æ•°æ®æ¨¡æ‹Ÿ**: ä½¿ç”¨éšæœºæ¸¸èµ°æ¨¡å‹ç”Ÿæˆæ¨¡æ‹Ÿçš„è‚¡ç¥¨ä»·æ ¼æ•°æ®
- **å¤šç²’åº¦èšåˆ**: æ”¯æŒ 1åˆ†é’Ÿã€5åˆ†é’Ÿã€15åˆ†é’Ÿã€30åˆ†é’Ÿç­‰å¤šç§æ—¶é—´ç²’åº¦
- **K çº¿å›¾**: å®æ—¶ç»˜åˆ¶å¼€é«˜æ”¶ä½ä»·æ ¼å’Œæˆäº¤é‡
- **æ•°æ®æŸ¥è¯¢**: RESTful API æ”¯æŒåˆ›å»ºåºåˆ—ã€æ·»åŠ æ•°æ®ã€æŸ¥è¯¢èšåˆæ•°æ®

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨åç«¯æœåŠ¡

```bash
cd server
npm run dev
```

åç«¯å°†è¿è¡Œåœ¨ `http://localhost:3000`

### 2. å¯åŠ¨å‰ç«¯æœåŠ¡

```bash
cd app
npm run dev
```

å‰ç«¯å°†è¿è¡Œåœ¨ `http://localhost:5173`

### 3. è®¿é—®æ—¶é—´åºåˆ—æ¨¡æ‹Ÿé¡µé¢

åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼š
```
http://localhost:5173/time-series
```

## ğŸ“¡ API ç«¯ç‚¹

### 1. åˆ›å»ºæ—¶é—´åºåˆ—

**POST** `/api/time-series/series`

```json
{
  "seriesId": "STOCK-SIM-001",
  "name": "æ¨¡æ‹Ÿè‚¡ç¥¨ AAPL",
  "dataType": "CONTINUOUS",
  "granularityLevels": ["MIN_1", "MIN_5", "MIN_15", "MIN_30"],
  "metrics": ["OPEN", "HIGH", "LOW", "CLOSE", "VOLUME", "VWAP"]
}
```

### 2. æ‰¹é‡æ·»åŠ æ•°æ®ç‚¹

**POST** `/api/time-series/data-points`

```json
{
  "seriesId": "STOCK-SIM-001",
  "dataPoints": [
    {
      "timestamp": "2026-01-27T10:00:00.000Z",
      "value": 100,
      "metadata": { "volume": 1000 }
    }
  ]
}
```

### 3. ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®ï¼ˆä»…é¢„è§ˆï¼‰

**POST** `/api/time-series/simulate`

```json
{
  "seriesId": "STOCK-SIM-001",
  "baseTime": "2026-01-27T10:00:00.000Z",
  "pointCount": 100,
  "intervalSeconds": 60,
  "initialPrice": 100,
  "baseVolume": 1000,
  "priceVolatility": 0.01,
  "volumeVolatility": 0.5
}
```

### 4. ç”Ÿæˆå¹¶æ·»åŠ æ¨¡æ‹Ÿæ•°æ®

**POST** `/api/time-series/simulate-and-add`

```json
{
  "seriesId": "STOCK-SIM-001",
  "baseTime": "2026-01-27T10:00:00.000Z",
  "pointCount": 100,
  "intervalSeconds": 60,
  "initialPrice": 100,
  "baseVolume": 1000,
  "priceVolatility": 0.01,
  "volumeVolatility": 0.5
}
```

### 5. æŸ¥è¯¢èšåˆæ•°æ®

**GET** `/api/time-series/aggregated?seriesId=STOCK-SIM-001&granularity=MIN_1&startTime=2026-01-27T10:00:00.000Z&endTime=2026-01-27T12:00:00.000Z`

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "data": [
    {
      "seriesId": "STOCK-SIM-001",
      "granularity": "MIN_1",
      "startTime": "2026-01-27T10:00:00.000Z",
      "endTime": "2026-01-27T10:01:00.000Z",
      "open": 100,
      "high": 100,
      "low": 100,
      "close": 100,
      "volume": 1000,
      "vwap": 100,
      "dataPointCount": 1,
      "createdAt": "2026-01-27T10:01:00.000Z",
      "updatedAt": "2026-01-27T10:01:00.000Z"
    }
  ],
  "count": 100
}
```

### 6. è·å–æœ€æ–°æ•°æ®

**GET** `/api/time-series/latest/:seriesId/:granularity`

ç¤ºä¾‹: `/api/time-series/latest/STOCK-SIM-001/MIN_1`

### 7. è·å–æ‰€æœ‰åºåˆ— ID

**GET** `/api/time-series/series`

### 8. åˆ é™¤åºåˆ—

**DELETE** `/api/time-series/series/:seriesId`

ç¤ºä¾‹: `/api/time-series/series/STOCK-SIM-001`

### 9. æ¸…é™¤èšåˆæ•°æ®

**DELETE** `/api/time-series/aggregated/:seriesId`

å¯é€‰æŸ¥è¯¢å‚æ•°: `beforeTime` (æ¸…é™¤æŒ‡å®šæ—¶é—´ä¹‹å‰çš„æ•°æ®)

ç¤ºä¾‹: `/api/time-series/aggregated/STOCK-SIM-001?beforeTime=2026-01-27T11:00:00.000Z`

## ğŸ“± å‰ç«¯ä½¿ç”¨è¯´æ˜

### é¡µé¢åŠŸèƒ½

æ—¶é—´åºåˆ—æ¨¡æ‹Ÿé¡µé¢æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š

1. **é…ç½®é¢æ¿**
   - è®¾ç½®åºåˆ— ID
   - è®¾ç½®å¼€å§‹æ—¶é—´
   - é…ç½®æ•°æ®ç‚¹æ•°é‡ã€æ—¶é—´é—´éš”
   - è°ƒæ•´ä»·æ ¼å’Œæˆäº¤é‡æ³¢åŠ¨ç‡

2. **æ“ä½œæŒ‰é’®**
   - ç”Ÿæˆå¹¶æ·»åŠ æ•°æ®: åˆ›å»ºåºåˆ—å¹¶ç”Ÿæˆæ•°æ®
   - ä»…ç”Ÿæˆé¢„è§ˆ: ä»…ç”Ÿæˆæ•°æ®ä¸æ·»åŠ 
   - æŸ¥è¯¢æ•°æ®: ä»åç«¯æŸ¥è¯¢èšåˆæ•°æ®
   - æ¸…é™¤æ•°æ®: æ¸…é™¤åºåˆ—çš„æ‰€æœ‰èšåˆæ•°æ®

3. **æ•°æ®å¯è§†åŒ–**
   - K çº¿å›¾ï¼šæ˜¾ç¤ºå¼€é«˜æ”¶ä½ä»·æ ¼
   - æˆäº¤é‡æŸ±çŠ¶å›¾ï¼šæ˜¾ç¤ºæˆäº¤é‡
   - é¢œè‰²åŒºåˆ†ï¼šç»¿è‰²ä¸Šæ¶¨ï¼Œçº¢è‰²ä¸‹è·Œ
   - å¤šç²’åº¦æ”¯æŒï¼šå¯åˆ‡æ¢ 1åˆ†é’Ÿ/5åˆ†é’Ÿ/15åˆ†é’Ÿ/30åˆ†é’Ÿ

4. **æ•°æ®è¡¨æ ¼**
   - æ˜¾ç¤ºè¯¦ç»†çš„èšåˆæ•°æ®
   - åŒ…å«æ—¶é—´ã€OHLCã€æˆäº¤é‡ã€VWAPç­‰ä¿¡æ¯
   - æ”¯æŒæ’åºå’Œç­›é€‰

### ä½¿ç”¨æµç¨‹

1. é…ç½®æ¨¡æ‹Ÿå‚æ•°
2. ç‚¹å‡»"ç”Ÿæˆå¹¶æ·»åŠ æ•°æ®"
3. ç­‰å¾…æ•°æ®ç”Ÿæˆå®Œæˆ
4. é€‰æ‹©ç²’åº¦æŸ¥çœ‹ä¸åŒæ—¶é—´å‘¨æœŸçš„æ•°æ®
5. æŸ¥çœ‹å›¾è¡¨å’Œæ•°æ®è¡¨æ ¼

## ğŸ”§ æ•°æ®æ¨¡å‹è¯´æ˜

### AggregatedPointï¼ˆèšåˆæ•°æ®ç‚¹ï¼‰

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| seriesId | string | åºåˆ— ID |
| granularity | string | æ—¶é—´ç²’åº¦ï¼ˆMIN_1, MIN_5 ç­‰ï¼‰ |
| startTime | Date | çª—å£å¼€å§‹æ—¶é—´ |
| endTime | Date | çª—å£ç»“æŸæ—¶é—´ |
| open | number | å¼€ç›˜ä»· |
| high | number | æœ€é«˜ä»· |
| low | number | æœ€ä½ä»· |
| close | number | æ”¶ç›˜ä»· |
| volume | number | æˆäº¤é‡ï¼ˆç´¯åŠ ï¼‰ |
| vwap | number \| undefined | æˆäº¤é‡åŠ æƒå¹³å‡ä»· |
| dataPointCount | number | åŸå§‹æ•°æ®ç‚¹æ•°é‡ |
| createdAt | Date | åˆ›å»ºæ—¶é—´ï¼ˆç­‰äºçª—å£ç»“æŸæ—¶é—´ï¼‰ |
| updatedAt | Date | æ›´æ–°æ—¶é—´ï¼ˆç­‰äºçª—å£ç»“æŸæ—¶é—´ï¼‰ |

## ğŸ“Š å›¾è¡¨è¯´æ˜

### K çº¿å›¾å…ƒç´ 

- **å®ä½“çº¿**: å¼€ç›˜ä»·åˆ°æ”¶ç›˜ä»·ï¼ˆç²—çº¿ï¼‰
  - ç»¿è‰²: æ”¶ç›˜ä»· â‰¥ å¼€ç›˜ä»·ï¼ˆä¸Šæ¶¨ï¼‰
  - çº¢è‰²: æ”¶ç›˜ä»· < å¼€ç›˜ä»·ï¼ˆä¸‹è·Œï¼‰

- **å½±çº¿**: æœ€é«˜ä»·åˆ°æœ€ä½ä»·ï¼ˆç»†çº¿ï¼‰
  - ä¸å®ä½“çº¿é¢œè‰²ç›¸åŒ
  - é€æ˜åº¦ 30%

- **æœ€é«˜/æœ€ä½ä»·æ ‡è®°**: æ¯5ä¸ªKçº¿æ˜¾ç¤º
  - åœ†ç‚¹æ ‡è®°æœ€é«˜ä»·
  - åœ†ç‚¹æ ‡è®°æœ€ä½ä»·

- **æˆäº¤é‡æŸ±çŠ¶å›¾**
  - ç»¿è‰²æŸ±: ä¸Šæ¶¨Kçº¿çš„æˆäº¤é‡
  - çº¢è‰²æŸ±: ä¸‹è·ŒKçº¿çš„æˆäº¤é‡
  - é«˜åº¦æŒ‰æ¯”ä¾‹ç¼©æ”¾

## ğŸ¯ æœ€ä½³å®è·µ

1. **æ•°æ®ç”Ÿæˆ**
   - ç”Ÿæˆè¶³å¤Ÿçš„æ•°æ®ç‚¹ä»¥è§¦å‘æ‰€æœ‰çª—å£å…³é—­
   - ä½¿ç”¨é€‚å½“çš„æ—¶é—´é—´éš”ï¼ˆå»ºè®®60ç§’-300ç§’ï¼‰
   - è°ƒæ•´æ³¢åŠ¨ç‡ä»¥æ¨¡æ‹Ÿä¸åŒå¸‚åœºç¯å¢ƒ

2. **æ€§èƒ½ä¼˜åŒ–**
   - æ‰¹é‡æ·»åŠ æ•°æ®ç‚¹è€Œéå•ä¸ªæ·»åŠ 
   - åˆç†è®¾ç½®ç²’åº¦çº§åˆ«ï¼ˆé¿å…è¿‡å¤šç²’åº¦ï¼‰
   - å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®

3. **æ•°æ®éªŒè¯**
   - æ£€æŸ¥æ—¶é—´é¡ºåºï¼Œä¸èƒ½é€†æ—¶æ·»åŠ 
   - éªŒè¯ä»·æ ¼å’Œæˆäº¤é‡çš„åˆç†æ€§
   - ç¡®ä¿èšåˆæ•°æ®çš„å‡†ç¡®æ€§

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ—¶é—´é¡ºåº**: æ•°æ®ç‚¹å¿…é¡»æŒ‰æ—¶é—´é¡ºåºæ·»åŠ ï¼Œå¦åˆ™ä¼šæŠ›å‡ºé”™è¯¯
2. **çª—å£å…³é—­**: æœ€åä¸€ä¸ªçª—å£éœ€è¦é¢å¤–çš„æ•°æ®ç‚¹æˆ–ä¸»åŠ¨æ¸…ç†æ‰èƒ½æ˜¾ç¤ºèšåˆæ•°æ®
3. **å†…å­˜ç®¡ç†**: é•¿æ—¶é—´åºåˆ—ä¼šå ç”¨å†…å­˜ï¼Œå»ºè®®å®šæœŸæ¸…ç†
4. **å¹¶å‘é™åˆ¶**: API æœ‰é€Ÿç‡é™åˆ¶ï¼ˆ15åˆ†é’Ÿå†…æœ€å¤š1000ä¸ªè¯·æ±‚ï¼‰

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [æ—¶é—´åºåˆ—æ¨¡å—æ–‡æ¡£](../types/timeSeries/README.md)
- [æµ‹è¯•æ–‡æ¡£](../../scripts/test-time-series.ts)

## ğŸ“ æŠ€æœ¯æ ˆ

- **åç«¯**: Node.js + Express + TypeScript
- **å‰ç«¯**: Vue 3 + Vite + Element Plus
- **æ•°æ®å¯è§†åŒ–**: SVG åŸç”Ÿç»˜åˆ¶ï¼ˆæ— éœ€é¢å¤–ä¾èµ–ï¼‰
- **æ•°æ®å­˜å‚¨**: å†…å­˜å­˜å‚¨ï¼ˆä¸æŒä¹…åŒ–ï¼‰

## ğŸ“„ æ–‡ä»¶ç»“æ„

```
server/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â””â”€â”€ timeSeriesRoutes.ts      # æ—¶é—´åºåˆ— API è·¯ç”±
â”‚   â””â”€â”€ services/
â”‚       â”œâ”€â”€ timeSeriesService.ts     # æ—¶é—´åºåˆ—æœåŠ¡
â”‚       â””â”€â”€ timeSeriesSimulationService.ts  # æ•°æ®æ¨¡æ‹ŸæœåŠ¡
â”œâ”€â”€ types/
â”‚   â””â”€â”€ timeSeries/              # æ—¶é—´åºåˆ—æ•°æ®ç»“æ„
â””â”€â”€ docs/
    â””â”€â”€ time-series-simulation.md  # æœ¬æ–‡æ¡£

app/
â””â”€â”€ src/
    â”œâ”€â”€ components/
    â”‚   â””â”€â”€ TimeSeriesSimulation.vue  # å‰ç«¯ç»„ä»¶
    â””â”€â”€ router/
        â””â”€â”€ index.ts               # è·¯ç”±é…ç½®
```

## ğŸ‰ å¼€å§‹ä½¿ç”¨

ç°åœ¨å°±å¯ä»¥å¯åŠ¨æœåŠ¡å¹¶ä½“éªŒæ—¶é—´åºåˆ—æ¨¡æ‹ŸåŠŸèƒ½äº†ï¼

```bash
# ç»ˆç«¯ 1: å¯åŠ¨åç«¯
cd server && npm run dev

# ç»ˆç«¯ 2: å¯åŠ¨å‰ç«¯
cd app && npm run dev
```

ç„¶ååœ¨æµè§ˆå™¨æ‰“å¼€:
```
http://localhost:5173/time-series
```

ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼ğŸš€
